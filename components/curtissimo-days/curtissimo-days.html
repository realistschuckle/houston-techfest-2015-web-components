<link rel="import" href="/bower_components/polymer/polymer.html">

<dom-module id="curtissimo-days">
  <style>
    .calendar-holder {
      flex: 0 0 320px;
      box-shadow: 1px 0 1px 0 black;
      position: relative;
      z-index: 2;
    }

    #calendar {
      height: 320px;
      width: 300vw;
      -webkit-user-select: none;
      -moz-user-select: none;
      -ms-user-select: none;
      user-select: none;
      cursor: default;
    }

    #calendar > .month {
      display: inline-block;
      position: relative;
      width: 100vw;
      height: 100%;
      vertical-align: top;
      box-sizing: border-box;
      overflow: hidden;
    }

    #calendar .day-container {
      height: 100%;
      background-color: white;
    }

    #calendar .day-container > :first-child {
      border-left: 1px inset #D32F2F;
    }

    .saturday,
    .sunday {
      background-color: #C5CAE9;
    }

    #calendar > .day-30 > .day-container > .day,
    #calendar > .day-31 > .day-container > .day {
      box-sizing: border-box;
      text-align: center;
      position: relative;
      border-right: 1px solid #ECEFF1;
    }

    #calendar > .day-30 > .day-container > .day {
      flex-basis: 3.33333333333333vw;
    }

    #calendar > .day-31 > .day-container > .day {
      flex-basis: 3.2258064516129vw;
    }

    #calendar > .day-30 > .day-container > .day > .appt {
      width: 3.33333333333333vw;
    }

    #calendar > .day-31 > .day-container > .day > .appt {
      width: 3.2258064516129vw;
    }

    #calendar > .month > header {
      position: absolute;
      bottom: 0;
      left: 10px;
      color: rgba(62, 39, 35, .1);
      font-size: 100px;
      font-weight: 700;
      z-index: 1;
    }

    .today {
      background-color: #FFF59D;
    }

    .selected {
      background-color: #FFEB3B;
    }

    .day:hover {
      background-color: #FBC02D;
    }

    .day-1:before {
      content: "1";
    }

    .day-2:before {
      content: "2";
    }

    .day > .appt {
      position: absolute;
      color: white;
    }

    .day > .appt:nth-child(2n) {
      background-color: rgba(62, 39, 35, .75);
    }

    .day > .appt:nth-child(2n + 1) {
      background-color: rgba(239, 108, 0, .75);
    }

    .a8 {
      top: 40px;
    }

    .a9 {
      top: 60px;
    }

    .a10 {
      top: 80px;
    }

    .a15 {
      top: 180px;
    }

    .a20 {
      top: 280px;
    }

    .h0-25 {
      height: 5px;
    }

    .h0-5 {
      height: 10px;
    }

    .h1 {
      height: 20px;
    }

    .h3 {
      height: 60px;
    }

    .overflow-horizontal {
      overflow-x: auto;
      overflow-y: hidden;
    }

    .overflow-vertical {
      overflow-y: auto;
      overflow-x: hidden;
    }
  </style>
  <template>
    <div class="overflow-horizontal calendar-holder">
      <div id="calendar">
        <template is="dom-repeat" items="{{calendar}}">
          <section class="{{item.className}}">
            <header>{{item.name}}</header>
            <div class="day-container layout horizontal">
              <template is="dom-repeat" items="{{item.days}}">
                <div class="{{item.className}}">{{item.number}}</div>
              </template>
            </div>
          </section>
        </template>
      </div>
    </div>
  </template>
  <script>
    var months = [
      'January',
      'February',
      'March',
      'April',
      'May',
      'June',
      'July',
      'August',
      'September',
      'October',
      'November',
      'December'
    ];

    var days = [
      'Sunday',
      'Monday',
      'Tuesday',
      'Wednesday',
      'Thursday',
      'Friday',
      'Saturday'
    ];

    function Month(year, month) {
      this.date = new Date(year, month, 1);
      this.days = [];
      var d = new Date(this.date.valueOf());
      while (d.getMonth() === month) {
        this.days.push(new Day(new Date(d.valueOf())));
        d.setDate(d.getDate() + 1);
      }
    }
    Object.defineProperty(Month.prototype, 'className', {
      get: function () {
        return 'month day-' + this.days.length;
      }
    });
    Object.defineProperty(Month.prototype, 'name', {
      get: function () {
        return months[this.date.getMonth()];
      }
    });

    function Day(date) {
      this.date = date;
    }
    Object.defineProperty(Day.prototype, 'className', {
      get: function () {
        return ('day ' + days[this.date.getDay()]).toLowerCase();
      }
    });
    Object.defineProperty(Day.prototype, 'number', {
      get: function () {
        return this.date.getDate();
      }
    });

    Polymer({
      is: 'curtissimo-days',

      created: function () {
        console.log('this', arguments.callee.toString());
        console.log('this', this.calendar);
        var d = new Date();
        var year = d.getFullYear();
        var month = d.getMonth();
        this.calendar = {
          months: [
            new Month(year, month - 1),
            new Month(year, month),
            new Month(year, month + 1)
          ]
        };
      }
    });
  </script>
</dom-module>
